!function(e){var t={};function n(o){if(t[o])return t[o].exports;var r=t[o]={i:o,l:!1,exports:{}};return e[o].call(r.exports,r,r.exports,n),r.l=!0,r.exports}n.m=e,n.c=t,n.d=function(e,t,o){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(n.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)n.d(o,r,function(t){return e[t]}.bind(null,r));return o},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=4)}([function(e,t){e.exports=require("express")},function(e,t){e.exports=require("mongodb")},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const o=n(1),r=process.env.MONGO_URL_PROD||"mongodb://localhost:27017";t.getGraphs=function(){return new Promise((e,t)=>{o.MongoClient.connect(r,(n,o)=>{n?t(n):o.db("easygraph").collection("graphs").find({}).limit(20).toArray().then(t=>{e(t)}).catch(e=>t(e))})})},t.getGraph=function(e){return new Promise((t,n)=>{o.MongoClient.connect(r,(r,c)=>{r?n(r):c.db("easygraph").collection("graphs").findOne({_id:new o.ObjectID(e)}).then(e=>t(e)).catch(e=>n(e))})})},t.postGraph=function(e){return new Promise((t,n)=>{const c=Object.assign({},e,{created:new Date,updated:new Date});o.MongoClient.connect(r,(e,o)=>{e?n(e):o.db("easygraph").collection("graphs").insertOne(c).then(()=>t(c)).catch(e=>n(e))})})},t.putGraph=function(e,t){return new Promise((n,c)=>{o.MongoClient.connect(r,(r,s)=>{if(r)c(r);else{const r=s.db("easygraph").collection("graphs"),a=Object.assign({},t,{updated:new Date}),u={_id:new o.ObjectID(e)},i={$set:a},l={returnOrigonal:!1,upsert:!1};r.findOneAndUpdate(u,i,l).then(()=>n()).catch(e=>c(e))}})})},t.deleteGraph=function(e){return new Promise((t,n)=>{o.MongoClient.connect(r,(r,c)=>{const s=c.db("easygraph").collection("graphs"),a={_id:new o.ObjectID(e)};s.findOneAndDelete(a).then(()=>t()).catch(e=>n(e))})})}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const o=n(0),r=n(2);t.router=o.Router(),t.router.get("/",(e,t)=>{console.log("Entra a /"),r.getGraphs().then(e=>t.json(e)).catch(e=>t.status(500).send(e))}),t.router.get("/:id",(e,t)=>{r.getGraph(e.params.id).then(e=>t.json(e)).catch(e=>t.status(500).send(e))}),t.router.post("/",(e,t)=>{const n=e.body;r.postGraph(n).then(()=>t.json(n)).catch(()=>t.status(500).send("No se guardo la peli"))}),t.router.put("/",(e,t,n)=>{const o=e.body.id;r.putGraph(o,e.body).then(e=>t.send(e)).catch(e=>n(e))}),t.router.delete("/:id",(e,t)=>{const n=e.params.id;r.deleteGraph(n).then(e=>t.send(e)).catch(e=>t.status(404).send(e))})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const o=n(0),r=n(3),c=o();c.use(o.json()),c.use("/graphs",r.router),c.get("/",(e,t)=>{t.send("Hello world from API")}),c.listen("3000",()=>console.log("App listening on port 3000"))}]);